<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Record Gallery - PigStyle Records</title>
    <link rel='stylesheet' href='style.css'>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: url('images/background.png') no-repeat center center fixed; 
            background-size: cover; 
            color: #eee; 
            text-align: center; 
            margin: 0;
            padding: 20px;
        }
        .gallery-popup { 
            display: flex;
            flex-direction: column;
            gap: 15px; 
            max-height: 70vh; 
            overflow-y: auto; 
            padding: 10px; 
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        .card { 
            display: flex; 
            flex-direction: row; 
            align-items: center; 
            background: #222; 
            border-radius: 8px; 
            padding: 12px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.3); 
            transition: all 0.2s ease; 
            height: 140px;
            width: 100%;
            box-sizing: border-box;
        }
        .card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
            transform: translateY(-2px);
        }
        .card img { 
            width: 100px; 
            height: 100px; 
            border-radius: 6px; 
            margin-right: 15px; 
            object-fit: cover;
        }
        .card-info { 
            display: flex; 
            flex-direction: column; 
            text-align: left; 
            flex: 1;
            height: 100%;
            justify-content: space-between;
        }
        .card-info h3 { 
            margin: 0 0 8px 0; 
            font-size: 1.1rem;
            line-height: 1.3;
            max-height: 2.6em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        .card-info p { 
            margin: 4px 0; 
            font-size: 0.9rem;
        }
        .card.highlight { 
            box-shadow: 0 0 0 2px #0ff; 
            opacity: 1; 
        }
        .card.not-highlight { 
            opacity: 0.4; 
        }
        input[type='text'] { 
            padding: 12px; 
            width: 80%; 
            max-width: 400px; 
            border-radius: 6px; 
            border: none; 
            font-size: 1rem; 
            margin-bottom: 15px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        header { 
            text-align: left; 
            padding: 10px; 
        }
        .search-container {
            margin: 20px 0;
        }
        .price {
            color: #0ff;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .genre {
            color: #aaa;
            font-size: 0.85rem;
        }
        
        /* Custom scrollbar for eBay-like feel */
        .gallery-popup::-webkit-scrollbar {
            width: 8px;
        }
        .gallery-popup::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }
        .gallery-popup::-webkit-scrollbar-thumb {
            background: rgba(0,255,255,0.5);
            border-radius: 4px;
        }
        .gallery-popup::-webkit-scrollbar-thumb:hover {
            background: rgba(0,255,255,0.7);
        }
        
        /* Loading animation */
        .loading-dots {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
        }
        .loading-dots div {
            position: absolute;
            top: 33px;
            width: 13px;
            height: 13px;
            border-radius: 50%;
            background: #0ff;
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }
        .loading-dots div:nth-child(1) {
            left: 8px;
            animation: loading-dots1 0.6s infinite;
        }
        .loading-dots div:nth-child(2) {
            left: 8px;
            animation: loading-dots2 0.6s infinite;
        }
        .loading-dots div:nth-child(3) {
            left: 32px;
            animation: loading-dots2 0.6s infinite;
        }
        .loading-dots div:nth-child(4) {
            left: 56px;
            animation: loading-dots3 0.6s infinite;
        }
        @keyframes loading-dots1 {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
        @keyframes loading-dots3 {
            0% { transform: scale(1); }
            100% { transform: scale(0); }
        }
        @keyframes loading-dots2 {
            0% { transform: translate(0, 0); }
            100% { transform: translate(24px, 0); }
        }
    </style>
</head>
<body>
    <header>
        <a href='index.html'><img src='images/pigstyle_text.png' alt='PigStyle' style='height:60px; vertical-align:middle;'></a>
    </header>
    <h1>🎵 Record Gallery</h1>
    <div class='search-container'>
        <input type='text' id='searchBox' placeholder='Search artist or record...'>
    </div>
    <div class='gallery-popup' id='gallery'>
        <div id='loading'>
            <div class="loading-dots">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <p>Loading records...</p>
        </div>
    </div>

    <script>
        // Sample data - in a real implementation, this would come from gallery-data.json
        const sampleRecords = [
            {
                title: "Dark Side of the Moon",
                artist: "Pink Floyd",
                price: "$24.99",
                genre: "Progressive Rock",
                image: "images/records/dark-side.jpg"
            },
            {
                title: "Rumours",
                artist: "Fleetwood Mac",
                price: "$22.50",
                genre: "Soft Rock",
                image: "images/records/rumours.jpg"
            },
            {
                title: "Thriller",
                artist: "Michael Jackson",
                price: "$26.75",
                genre: "Pop",
                image: "images/records/thriller.jpg"
            },
            {
                title: "Abbey Road",
                artist: "The Beatles",
                price: "$28.99",
                genre: "Rock",
                image: "images/records/abbey-road.jpg"
            },
            {
                title: "Back in Black",
                artist: "AC/DC",
                price: "$21.25",
                genre: "Hard Rock",
                image: "images/records/back-in-black.jpg"
            },
            {
                title: "The Wall",
                artist: "Pink Floyd",
                price: "$27.50",
                genre: "Progressive Rock",
                image: "images/records/the-wall.jpg"
            },
            {
                title: "Hotel California",
                artist: "Eagles",
                price: "$23.99",
                genre: "Rock",
                image: "images/records/hotel-california.jpg"
            },
            {
                title: "Kind of Blue",
                artist: "Miles Davis",
                price: "$25.75",
                genre: "Jazz",
                image: "images/records/kind-of-blue.jpg"
            },
            {
                title: "Led Zeppelin IV",
                artist: "Led Zeppelin",
                price: "$29.99",
                genre: "Hard Rock",
                image: "images/records/led-zeppelin-iv.jpg"
            },
            {
                title: "Nevermind",
                artist: "Nirvana",
                price: "$24.50",
                genre: "Grunge",
                image: "images/records/nevermind.jpg"
            }
        ];

        // Store all records globally for search functionality
        let allRecords = [];

        // Load data from gallery-data.json
        async function loadGalleryData() {
            try {
                // In a real implementation, you would fetch from your JSON file
                // const response = await fetch('gallery-data.json');
                // allRecords = await response.json();
                
                // For demo purposes, using sample data
                allRecords = sampleRecords;
                
                // Simulate network delay
                setTimeout(() => {
                    displayRecords(allRecords);
                }, 800);
                
            } catch (error) {
                console.error('Error loading gallery data:', error);
                document.getElementById('gallery').innerHTML = '<div>Error loading records. Please try again later.</div>';
            }
        }

        // Display records in the gallery
        function displayRecords(records) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = ''; // Clear loading message

            records.forEach(record => {
                const card = document.createElement('div');
                card.className = 'card highlight';
                card.setAttribute('data-info', `${record.artist} ${record.title}`.toLowerCase());
                
                card.innerHTML = `
                    <img src="${record.image}" alt="${record.title}" onerror="this.src='images/default-record.jpg'">
                    <div class="card-info">
                        <h3>${escapeHtml(record.title)}</h3>
                        <p>${escapeHtml(record.artist)}</p>
                        <p class="price">${record.price}</p>
                        <p class="genre">${escapeHtml(record.genre)}</p>
                    </div>
                `;
                
                gallery.appendChild(card);
            });

            // Initialize search functionality
            initializeSearch();
        }

        // Initialize search functionality
        function initializeSearch() {
            const searchBox = document.getElementById('searchBox');
            
            searchBox.addEventListener('input', () => {
                const term = searchBox.value.toLowerCase().trim();
                
                if (!term) {
                    // If search is empty, show all records
                    displayRecords(allRecords);
                } else {
                    // Filter records based on search term
                    const filteredRecords = allRecords.filter(record => {
                        const searchString = `${record.artist} ${record.title}`.toLowerCase();
                        return searchString.includes(term);
                    });
                    
                    // Display filtered records
                    displayFilteredRecords(filteredRecords);
                }
            });
        }

        // Display filtered records with proper highlighting
        function displayFilteredRecords(filteredRecords) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = ''; // Clear current gallery

            // Create a map of filtered records for quick lookup
            const filteredMap = new Map();
            filteredRecords.forEach(record => {
                filteredMap.set(`${record.artist} ${record.title}`.toLowerCase(), record);
            });

            // Display all records, but highlight only the filtered ones
            allRecords.forEach(record => {
                const card = document.createElement('div');
                const recordKey = `${record.artist} ${record.title}`.toLowerCase();
                const isHighlighted = filteredMap.has(recordKey);
                
                card.className = isHighlighted ? 'card highlight' : 'card not-highlight';
                card.setAttribute('data-info', recordKey);
                
                card.innerHTML = `
                    <img src="${record.image}" alt="${record.title}" onerror="this.src='images/default-record.jpg'">
                    <div class="card-info">
                        <h3>${escapeHtml(record.title)}</h3>
                        <p>${escapeHtml(record.artist)}</p>
                        <p class="price">${record.price}</p>
                        <p class="genre">${escapeHtml(record.genre)}</p>
                    </div>
                `;
                
                gallery.appendChild(card);
            });
        }

        // Helper function to escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load the gallery data when page loads
        loadGalleryData();
    </script>
</body>
</html>